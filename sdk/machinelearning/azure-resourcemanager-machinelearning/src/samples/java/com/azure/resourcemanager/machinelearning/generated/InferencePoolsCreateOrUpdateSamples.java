// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
// Code generated by Microsoft (R) AutoRest Code Generator.

package com.azure.resourcemanager.machinelearning.generated;

import com.azure.resourcemanager.machinelearning.models.CodeConfiguration;
import com.azure.resourcemanager.machinelearning.models.InferencePoolProperties;
import com.azure.resourcemanager.machinelearning.models.ManagedServiceIdentity;
import com.azure.resourcemanager.machinelearning.models.ManagedServiceIdentityType;
import com.azure.resourcemanager.machinelearning.models.PoolEnvironmentConfiguration;
import com.azure.resourcemanager.machinelearning.models.PoolModelConfiguration;
import com.azure.resourcemanager.machinelearning.models.ProbeSettings;
import com.azure.resourcemanager.machinelearning.models.RequestConfiguration;
import com.azure.resourcemanager.machinelearning.models.Sku;
import com.azure.resourcemanager.machinelearning.models.SkuTier;
import com.azure.resourcemanager.machinelearning.models.UserAssignedIdentity;
import java.time.Duration;
import java.util.HashMap;
import java.util.Map;

/** Samples for InferencePools CreateOrUpdate. */
public final class InferencePoolsCreateOrUpdateSamples {
    /*
     * x-ms-original-file: specification/machinelearningservices/resource-manager/Microsoft.MachineLearningServices/preview/2023-08-01-preview/examples/Workspace/InferencePool/createOrUpdate.json
     */
    /**
     * Sample code: CreateOrUpdate Workspace Inference Pool.
     *
     * @param manager Entry point to MachineLearningManager.
     */
    public static void createOrUpdateWorkspaceInferencePool(
        com.azure.resourcemanager.machinelearning.MachineLearningManager manager) {
        manager
            .inferencePools()
            .define("string")
            .withRegion("string")
            .withExistingWorkspace("test-rg", "my-aml-workspace")
            .withProperties(
                new InferencePoolProperties()
                    .withDescription("string")
                    .withProperties(mapOf("string", "string"))
                    .withCodeConfiguration(
                        new CodeConfiguration().withCodeId("fakeTokenPlaceholder").withScoringScript("string"))
                    .withEnvironmentConfiguration(
                        new PoolEnvironmentConfiguration()
                            .withEnvironmentId("string")
                            .withEnvironmentVariables(mapOf("string", "string"))
                            .withLivenessProbe(
                                new ProbeSettings()
                                    .withFailureThreshold(1)
                                    .withInitialDelay(Duration.parse("PT5M"))
                                    .withPeriod(Duration.parse("PT5M"))
                                    .withSuccessThreshold(1)
                                    .withTimeout(Duration.parse("PT5M")))
                            .withReadinessProbe(
                                new ProbeSettings()
                                    .withFailureThreshold(1)
                                    .withInitialDelay(Duration.parse("PT5M"))
                                    .withPeriod(Duration.parse("PT5M"))
                                    .withSuccessThreshold(1)
                                    .withTimeout(Duration.parse("PT5M")))
                            .withStartupProbe(
                                new ProbeSettings()
                                    .withFailureThreshold(1)
                                    .withInitialDelay(Duration.parse("PT5M"))
                                    .withPeriod(Duration.parse("PT5M"))
                                    .withSuccessThreshold(1)
                                    .withTimeout(Duration.parse("PT5M"))))
                    .withModelConfiguration(new PoolModelConfiguration().withModelId("string"))
                    .withNodeSkuType("string")
                    .withRequestConfiguration(
                        new RequestConfiguration()
                            .withMaxConcurrentRequestsPerInstance(1)
                            .withRequestTimeout(Duration.parse("PT5M"))))
            .withTags(mapOf())
            .withIdentity(
                new ManagedServiceIdentity()
                    .withType(ManagedServiceIdentityType.USER_ASSIGNED)
                    .withUserAssignedIdentities(mapOf("string", new UserAssignedIdentity())))
            .withKind("string")
            .withSku(
                new Sku()
                    .withName("string")
                    .withTier(SkuTier.FREE)
                    .withSize("string")
                    .withFamily("string")
                    .withCapacity(1))
            .create();
    }

    // Use "Map.of" if available
    @SuppressWarnings("unchecked")
    private static <T> Map<String, T> mapOf(Object... inputs) {
        Map<String, T> map = new HashMap<>();
        for (int i = 0; i < inputs.length; i += 2) {
            String key = (String) inputs[i];
            T value = (T) inputs[i + 1];
            map.put(key, value);
        }
        return map;
    }
}
